Todo:
    Include the last frame into the simulation
    Add more unit tests

